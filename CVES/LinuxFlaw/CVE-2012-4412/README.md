# CVE-2012-4412

## Experiment Environment

Ubuntu 14.04LTS

CentOS 6.5

## INSTALL & Configuration

Preinstalled environment in CentOS 6.5

Installation for Ubuntu 14.04LTS

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2012-4412/glibc-2.17.tar.gz 
tar -xvf glibc-2.17.tar.gz
mkdir build
cd build
../glibc-2.17/configure
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

### Method 1 (CentOS 6.5)

```
gcc -o poc poc.c
./poc
```

### Method 2 (Ubuntu 14.04LTS)

```
gcc -o poc_dlopen poc_dlopen.c
./poc_dlopen
```

## PoCs

[Bug 14547 (CVE-2012-4412) - strcoll integer / buffer overflow (CVE-2012-4412, CVE-2012-4424)](https://sourceware.org/bugzilla/show_bug.cgi?id=14547)

[Bug 14552 (CVE-2012-4424) - Two security issues in strcoll() function](https://sourceware.org/bugzilla/show_bug.cgi?id=14552)

[GNU glibc 'strcoll()' Routine Integer Overflow Vulnerability](https://www.securityfocus.com/bid/55462/exploit)

[GNU glibc - 'strcoll()' Routine Integer Overflow](https://www.exploit-db.com/exploits/37783/)

[glibc: strcoll() integer overflow leading to buffer overflow + another alloca() stack overflow issue](http://www.openwall.com/lists/oss-security/2012/09/07/9)

## Vulnerability Patch

### Root Cause

### Stack Trace

### Patch

Details are in <https://sourceware.org/ml/libc-alpha/2013-06/msg01160.html>

## References
