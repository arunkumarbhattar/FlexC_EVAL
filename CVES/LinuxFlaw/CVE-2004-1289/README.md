# CVE-2006-2971

## Experiment Environment

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-1289/pcal-4.7.1.tar.gz
tar -xvf pcal-4.7.1.tar.gz
cd pcal-4.7.1/
make
```

## Problems in Installation & Configuration

N/A

## How to trigger vulnerability

```
./pcal -f 71-1.cal > 71-1.ps
```

```
./pcal -f 71-2.cal > 71-2.ps
```

## PoCs

[PCAL 4.x - Calendar File 'getline' Remote Buffer Overflow](https://www.exploit-db.com/exploits/25035/)

[PCAL 4.x - Calendar File 'get_holiday' Remote Buffer Overflow](https://www.exploit-db.com/exploits/25036/)


[PCAL Calendar File getline Buffer Overflow Vulnerability](http://www.securityfocus.com/bid/12035/exploit)
[PCAL Calendar File get_holiday Buffer Overflow Vulnerability](http://www.securityfocus.com/bid/12036/exploit)

[pcal Buffer Overflows Let Remote Users Execute Arbitrary Code](https://www.securitytracker.com/id/1012592)

## Vulnerability Details & Patch

### Root Cause

> In pcalutil.c, getline() copies any amount of data
> into a fixed-length tmpbuf array. In readfile.c, get_holiday() uses an
> unprotected strcpy() to copy data into a fixed-length tmp array.

### Stack Trace

## References
