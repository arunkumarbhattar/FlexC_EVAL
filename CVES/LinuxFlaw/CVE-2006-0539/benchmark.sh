#!/bin/bash

# Sample fcrontab files
samples=(
  "sample1.fcrontab"
  "sample2.fcrontab"
  "sample3.fcrontab"
)

# Function to create sample fcrontab files
create_samples() {
  for i in "${!samples[@]}"; do
    length=$(( (i + 1) * 500 ))
    echo "Creating sample ${samples[$i]} with length $length characters"
    perl -e "print 'pi3' x $length" > "${samples[$i]}"
  done
}

# Function to benchmark the patched Fcron
benchmark_fcron() {
  for sample in "${samples[@]}"; do
    echo "Converting $sample"
    start_time=$(date +%s.%N) # Record start time
    ./convert-fcrontab "$sample" # Convert the fcrontab file
    end_time=$(date +%s.%N) # Record end time
    elapsed_time=$(echo "$end_time - $start_time" | bc)
    echo "Elapsed time: $elapsed_time seconds"
  done
}

# Create sample fcrontab files
create_samples

# Run the benchmark
benchmark_fcron

# Clean up the sample files
rm -f "${samples[@]}"

