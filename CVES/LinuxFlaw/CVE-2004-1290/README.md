# CVE-2004-1290

## Experiment Environment

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-1290/pgn2web-0.3.tar.gz
tar -xvf pgn2web-0.3.tar.gz
cd pgn2web
make
```

## Problems in Installation & Configuration

N/A

## How to trigger vulnerability

```
./pgn2web 45.pgn 45.html
```

## PoCs

[PGN2WEB 0.3 - Remote Buffer Overflow](https://www.exploit-db.com/exploits/25023/)

[PGN2WEB Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/12023/exploit)

[pgn2web 0.3 process_moves overflows token buffer](http://securesoftware.list.cr.yp.to/archive/0/35)

## Vulnerability Details & Patch

### Root Cause

> In pgn2web.c, process_moves() uses fscanf() to read any
> number of bytes into a 256-byte token array.

### Stack Trace

## References
