# CVE-2013-4243

## Experiment Environment

Ubuntu 14.04LTS

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2013-4243/tiff-4.0.1.tar.gz
tar -xvf tiff-4.0.1.tar.gz
cd tiff-4.0.1
./configure
make
```

## Problems in Installation & Configuration


## How to trigger vulnerability

```
./tools/gif2tiff poc.gif poc.tif
```

## PoCs

[CVE-2013-4243 libtiff (gif2tiff): possible heap-based buffer overflow in readgifimage()](http://bugzilla.maptools.org/show_bug.cgi?id=2451#c10)

## Vulnerability Details & Patch

### Root Cause

A possible heap-based buffer overflow flaw was found in the readgifimage()
function in gif2tiff, a tool to convert GIF images to TIFF. A remote attacker
could provide a specially-crafted GIF file that, when processed by gif2tiff,
would cause gif2tiff to crash or, potentially, execute arbitrary code with the
privileges of the user running gif2tiff.

### Stack Trace

### Patch

```
--- gif2tiff.c	15 Dec 2010 00:22:44 -0000	1.12
+++ gif2tiff.c	14 Aug 2013 04:43:31 -0000
@@ -280,6 +280,10 @@
         fprintf(stderr, "no colormap present for image\n");
         return (0);
     }
+    if (width == 0 || height == 0) {
+        fprintf(stderr, "Invalid value of width or height\n");
+        return(0);
+    }
     if ((raster = (unsigned char*) _TIFFmalloc(width*height+EXTRAFUDGE)) == NULL) {
         fprintf(stderr, "not enough memory for image\n");
         return (0);
```

## References
