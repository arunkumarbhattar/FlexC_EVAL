# CVE-2004-0557

## Experiment Environment

CentOS 6.4

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-0557/sox-12.17.4-1.tar.gz
tar -xvf sox-12.17.4-1.tar.gz 
cd sox-12.17.4/
./configure
make
```


## Problems in Installation & Configuration

## How to trigger vulnerability

```
gcc -o s0x_poc s0x_poc.c
./s0x_poc
./sox BadWav.wav -t ossdsp /dev/dsp

python 369.py
./sox britney.wav -t ossdsp /dev/dsp


gcc -o exploit soxWAVFileBufferOverflowExploit.c
# gcc -o exploit 374.c
./exploit laser.wav malevolent.wav 0
```

## PoCs

[POC Exploit Code for s0x stack overflow vulnerability found by Ulf Harnhammar](http://downloads.securityfocus.com/vulnerabilities/exploits/s0x_poc.c)

[SoX - Local Buffer Overflow](https://www.exploit-db.com/exploits/369/)

[SoX - '.wav' Local Buffer Overflow](https://www.exploit-db.com/exploits/374/) or [soxWAVFileBufferOverflowExploit.c](https://packetstormsecurity.com/files/33905/soxWAVFileBufferOverflowExploit.c) or [SoX WAV File Buffer Overflow Vulnerability](https://downloads.securityfocus.com/vulnerabilities/exploits/soxWAVFileBufferOverflowExploit.c)

## Vulnerability Patch

[Patch](https://bugzilla.redhat.com/attachment.cgi?id=102037)

## References
