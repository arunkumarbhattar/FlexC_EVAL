# CVE-2004-0238

## Experiment Environment

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2006-2971/0verkill-0.16.tgz

tar -xvf 0verkill-0.16.tgz
0verkill-0.16

./configure
make
```

## Problems in Installation & Configuration

```
server.c:71:12: error: storage size of 'tm' isn't known
```
change `#include<sys/time.h>` to `#include<time.h>`


```
sprite.c:211:1 error: label at end of compound statement 
	skip:
	^
```
solution: add a ; empty statement

```
server.o: In function `update_game':
server.c:(.text+0x4fb2): undefined reference to `sin'
```
solution: add -lm link option to the end of make command of target server

```
xinterface.c:9:22: fatal error: X11/xpm.h: No such file or directory
	#include <X11/xpm.h>
```
Solution: `sudo apt-get install libxpm-dev`

```
xinterface.c:(.text+0xc): undefined reference to `XFlush'
```
Solution: add -lX11 link option to the end of make command of target x0verkill

```
xinterface.c(.text+0x328): undefined reference to `XpmCreatePixmapFromData'
```
Solution: add -lXpm link option to the end of make command of target x0verkill

all above problems are found in version 0.14 or before

## How to trigger vulnerability

```
gcc -o exploit 23634.c
./exploit
```

## PoCs

[0verkill 0.16 - Game Client Multiple Local Buffer Overflow Vulnerabilities](https://www.exploit-db.com/exploits/23634/)

[0verkill Game Client Multiple Local Buffer Overflow Vulnerabilities](https://downloads.securityfocus.com/vulnerabilities/exploits/0verkill-exploit.c)

## Vulnerability Patch

## References
