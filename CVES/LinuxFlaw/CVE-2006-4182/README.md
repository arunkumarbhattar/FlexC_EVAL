# CVE-2006-4182

## Experiment Environment

Ubuntu 10.04 LTS

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2006-4182/clamav-0.88.2.tar.gz
tar -xvf clamav-0.88.2.tar.gz
cd clamav-0.88.2
./configure
make
sudo make install
```

## Problems in Installation & Configuration


## How to trigger vulnerability

```
/usr/local/bin/clamscan 2587.exe
```

## PoCs

[Clam Anti-Virus PE Rebuilding Heap Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/20535/exploit)

[Clam AntiVirus 0.88.4 - 'rebuildpe' Remote Heap Overflow (PoC)](https://www.exploit-db.com/exploits/2587/)

## Vulnerability Details & Patch

### Root Cause

Integer overflow in rebuildpe.c of ClamAV 0.88.1 and 0.88.4, allows remote attackers to cause a denial of service (scanning service crash) via a crafted Portable Executable (PE) file that leads to a heap-based buffer overflow when less memory is allocated than expected.

### Stack Trace

### Patch

## References
