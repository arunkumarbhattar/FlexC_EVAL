# CVE-2007-0368

## Experiment Environment

Ubuntu 8.10

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2007-0368/mbsebbs-0.70.0.tar
tar -xvf mbsebbs-0.70.0.tar
cd mbsebbs-0.70.0
./configure
make
```

## Problems in Installation & Configuration


## How to trigger vulnerability

```
gcc -o exploit 22112.c
sudo ./exploit ./unix/mbuseradd
```

## PoCs

[MBSE-BBS MBSE_Root Multiple Local Privilege Escalation Vulnerabilites](https://www.securityfocus.com/bid/22112/exploit)

[GNU/Linux mbse-bbs 0.70.0 - Local Buffer Overflow](https://www.exploit-db.com/exploits/3154/)

## Vulnerability Details & Patch

### Root Cause

cat -n mbuseradd.c 

```
228    sprintf(shell, "%s/bin/mbsebbs", getenv("MBSE_ROOT"));
229    sprintf(homedir, "%s/%s", argv[4], argv[2]);
```

Stack-based buffer overflow in mbse-bbs 0.70 and earlier allows local users to execute arbitrary code via a long string in the MBSE_ROOT environment variable.

### Stack Trace

### Patch

## References
