# CVE-2004-1261

## Experiment Environment

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-1261/asp2php-0.76.23.tar.gz
tar -xvf asp2php-0.76.23.tar.gz 
cd asp2php-0.76.23/
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

```
./asp2php 29-1.asp
or 
./asp2php 29-2.asp
```

## PoCs

[ASP2PHP Preparse Temp Variable Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/12015/exploit)

[ASP2PHP 0.76.23 - Preparse Token Variable Buffer Overflow](https://www.exploit-db.com/exploits/25016/)

[asp2php Buffer Overflow in gettoken() Lets Remote Users Execute Arbitrary Code](https://securitytracker.com/id/1012572)

## Vulnerability Details & Patch

### Root Cause

> Both buffer overflows can be blamed on gettoken(), which has a
> fundamentally broken gets()-style API. The preparse() function calls
> gettoken() to read data into a 1024-byte token[] array, and to read data
> into a 1024-byte temp[] array.

### Stack Trace

## References
