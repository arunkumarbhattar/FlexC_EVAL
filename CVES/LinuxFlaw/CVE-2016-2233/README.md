# CVE-2016-2233

## Experiment Environment

Ubuntu 14.04LTS

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2016-2233/hexchat-2.10.0.tar.xz
tar -xvf hexchat-2.10.0.tar.xz
cd hexchat-2.10.0
./configure
make
```

## Problems in Installation & Configuration


## How to trigger vulnerability

Server:

```
cd src/fe-gtk
./hexchat
```

Client:

```
python poc.py
```

## PoCs

[Hexchat IRC Client 2.11.0 - CAP LS Handling Buffer Overflow](https://www.exploit-db.com/exploits/39657/)

[HexChat CVE-2016-2233 Stack-Based Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/95920/exploit)

## Vulnerability Patch

### Root Cause

### Stack Trace

### Patch

```
+	net = log_create_filename (net);
 	buf = g_strdup_printf ("%s" G_DIR_SEPARATOR_S "scrollback" G_DIR_SEPARATOR_S "%s" G_DIR_SEPARATOR_S "%s.txt", get_xdir (), net, "");
 	mkdir_p (buf);
 	g_free (buf);
@@ -89,6 +90,7 @@ scrollback_get_filename (session *sess)
 	else
 		buf = NULL;
 	g_free (chan);
+	g_free (net);
```

Details are in the References section

## References

<https://github.com/hexchat/hexchat/commit/15600f405f2d5bda6ccf0dd73957395716e0d4d3>
