# CVE-2011-1938

## Experiment Environment

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2011-1938/php-5.3.4.tar.bz2
tar -xvf php-5.3.4.tar.bz2
cd php-5.3.4
./configure
make
```

## Problems in Installation & Configuration


## How to trigger vulnerability

```
./sapi/cli/php poc1.php

./sapi/cli/php poc2.php
```

## PoCs

[PHP 5.3.5 - 'socket_connect()' Local Buffer Overflow](https://www.exploit-db.com/exploits/17318/)

[PHP 5.3.6 - Local Buffer Overflow (ROP)](https://www.exploit-db.com/exploits/17486/)

[CVE-2011-1938 PHP socket_connect() stack buffer overflow](http://seclists.org/fulldisclosure/2011/May/472)

## Vulnerability Patch

### Root Cause

### Stack Trace

### Patch

Details are in <http://svn.php.net/viewvc/php/php-src/branches/PHP_5_3/ext/sockets/sockets.c?r1=311369&r2=311368&pathrev=311369>

## References
