# CVE/EDB ID
CVE-2017-5853

## Experiment Environment
Ubuntu 14.04 LTS

## INSTALL & Configuration
```
download PoDoFo from sourceforge
tar xvf podofo.tar.gz
cd podofo 
mkdir build
cmake -G "Unix Makefiles" -DCMAKE_INSTALL_PREFIX="`pwd`/../podofo" -DCMAKE_BUILD_TYPE=Debug ..
make
make install
```

## Problems in Installation & Configuration
CMake Error at /usr/share/cmake-2.8/Modules/FindPackageHandleStandardArgs.cmake:108 (message):  
  Could NOT find FREETYPE (missing: FREETYPE\_LIBRARY FREETYPE\_INCLUDE\_DIR)  
```
sudo apt-get install libfreetype6-dev
```

Could not find fontconfig
```
sudo apt-get install libfontconfig1-dev
```
CMake Error at CMakeLists.txt:36 (CMAKE\_POLICY):
Policy "CMP0033" is not known to this version of CMake.

solution 1: use higher version cmake
solution 2: delete CMakeLists.txt:36

## How to trigger vulnerability
$HOME\_PoDoFo/bin/podofopdfinfo $FILE

## PoCs
Inside the folder

## Vulnerability Details & Patch

### Root Cause

### Stack Trace
/tmp/portage/app-text/podofo-0.9.4/work/podofo-0.9.4/src/base/PdfParser.cpp:757:23: runtime error: signed integer overflow: 9223372036854775807 + 9 cannot be represented in type 'long'

## References
https://blogs.gentoo.org/ago/2017/02/01/podofo-signed-integer-overflow-in-pdfparser-cpp/
