# CVE-2004-1279

## Experiment Environment

CentOS 6.5

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-1279/jpegtoavi-1.5.tar.gz
tar -xvf jpegtoavi-1.5.tar.gz
cd jpegtoavi-1.5
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

```
./jpegtoavi -f 1 640 480 < 10.list
```

## PoCs

[jpegtoavi Buffer Overflow in get_file_list_stdin() Lets Remote Users Execute Arbitrary Code](https://securitytracker.com/id/1012559)

[JPegToAvi 1.5 - File List Buffer Overflow](https://www.exploit-db.com/exploits/24981/)

[JPegToAvi File List Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/11976/exploit)

## Vulnerability Details & Patch

### Root Cause

> In jpegtoavi.c, get_file_list_stdin() uses an
> unprotected %s scanf to read any number of bytes into an fn[] array.

```
jpegtoavi.c:126

	strcpy(tmp->name, fn);
```

### Stack Trace

## References
