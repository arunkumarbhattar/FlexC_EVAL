# CVE-2015-7805

## Experiment Environment
Ubuntu 14.04

## INSTALL & Configuration
```
wget http://www.mega-nerd.com/libsndfile/files/libsndfile-1.0.25.tar.gz
tar xvf libsndfile-1.0.25.tar.gz
cd libsndfile-1.0.25

./configure
make -j
```
## Problems in Installation & Configuration

## How to trigger vulnerability
```
chmod +x poc.pl
./poc.pl
cd libsndfile/programs/
./sndfile-play nemux.aiff
```
explanation: `sndfile-play` is actually a wrapper, the real program is '.libs/lt-sndfile-play'


## Root Cause Statement
```
aiff.c
aiff_read_header() {
520:	case COMT_MARKER:
541: 	dword -= psf_binheader_readf(psf, "b", cptr, len);
}

common.c
psf_binheader_readf() {
1037:	case 'b':
1039:		count = va_arg(argptr, size_t);
1041:		bytes_count = header_read(psf, charptr, count); // count could be 14000 (0x36B0)
}

header_read (SF_PRIVATE *psf, void *ptr, int bytes) {
810:	most = SIGNED_SIZEOF(psf->header) - psf->headindex; // psf->headindex is controlled by input
811:	psf_fread (psf->header + psf->headend, 1, most, psf); // read 'most' bytes from file to psf->header+psf->headend
	// psf is dynamically allocated

	memcpy(ptr, psf->header + psf->headindex, bytes); // you can exploit here
}
```

## PoCs
[exploit db](https://www.exploit-db.com/exploits/38447/)

## Vulnerability Patch

## References
