# CVE-2004-1262

## Experiment Environment

Ubuntu 11.04 or Ubuntu 14.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-1262/libbsb-0.0.6.tar.gz
tar -xvf libbsb-0.0.6.tar.gz
cd libbsb-0.0.6
./configure
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

```
./bsb2ppm 4.kap 4.ppm
```

One trick to get the right `4.kap` poc file:

```
1. first copy the content from the webpage into one temp file - temp;
2. qprint -d temp 4.kap
```

## PoCs

[ilibbsb bsb2ppm Buffer Overflow in bsb_open_header() Lets Remote Users Execute Arbitrary Code](https://securitytracker.com/id/1012543)

[bsb2ppm 0.0.6 overflows line buffer](http://securesoftware.list.cr.yp.to/archive/0/13)

## Vulnerability Details & Patch

### Root Cause

> In libbsb, in bsb_io.c, bsb_open_header() uses
> next_line() to copy a line of any length into a 1024-byte line[] buffer.

### Stack Trace

## References

[qprint manpage](https://www.fourmilab.ch/webtools/qprint/)
