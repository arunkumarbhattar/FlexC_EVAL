#CVE-2006-6563

## Experiment Environment

Ubuntu 14.04 LTS

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2006-6563/proftpd-1.3.0a.tar.gz

tar -xvf proftpd-1.3.0a.tar.gz
cd proftpd-1.3.0a

./configure	<= Special configuration here
make
```
The special configuration option is ```--enable-ctrls```

## Problems in Installation & Configuration

## How to trigger vulnerability

```
sudo /usr/local/sbin/proftpd -n
sudo perl 3330.pl /usr/local/var/proftpd/proftpd.sock 1
sudo perl 3333.pl /usr/local/var/proftpd/proftpd.sock 1
python 2928.py
```

## PoCs

[ProFTPd 1.3.0a - (mod_ctrls support) Local Buffer Overflow (PoC)](https://www.exploit-db.com/exploits/2928/)

[ProFTPd 1.3.0/1.3.0a - (mod_ctrls support) Local Buffer Overflow (1)](https://www.exploit-db.com/exploits/3330/)

[ProFTPd 1.3.0/1.3.0a - (mod_ctrls support) Local Buffer Overflow (2)](https://www.exploit-db.com/exploits/3333/)

[ProFTPd 1.3.0/1.3.0a - (mod_ctrls) Local Overflow (exec-shield)](https://www.exploit-db.com/exploits/3730/)

## Vulnerability Details & Patch

### Root Cause

```
ctrls.c:529

	if (read(cl->cl_fd, reqaction, reqarglen) < 0) {
```

### Stack Trace

```
(gdb) info stack
#0  0xcccccccc in ?? ()
Cannot access memory at address 0xffffe77b
```

## References
